<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mannequin Animation Editor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="animation-editor.css">
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/",
                "mannequin": "../../src/mannequin.js",
                "mannequin/": "../../src/"
            }
        }
    </script>
</head>
<body>
    <!-- Main Container -->
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="app-title">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    Mannequin Animation Studio
                </h1>
            </div>
            <div class="header-right">
                <button id="btn-new" class="btn btn-secondary" title="New Animation">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M12 5v14M5 12h14"/>
                    </svg>
                    New
                </button>
                <button id="btn-load" class="btn btn-secondary" title="Load Animation">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 14V3"/>
                    </svg>
                    Load
                </button>
                <button id="btn-save" class="btn btn-primary" title="Save Animation">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                        <polyline points="17 21 17 13 7 13 7 21"/>
                        <polyline points="7 3 7 8 15 8"/>
                    </svg>
                    Save
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Panel - Controls -->
            <aside class="left-panel">
                <div class="panel-section">
                    <h3 class="section-title">Animation Info</h3>
                    <div class="form-group">
                        <label for="anim-name">Name</label>
                        <input type="text" id="anim-name" class="input" placeholder="My Animation" value="Untitled Animation">
                    </div>
                    <div class="form-group">
                        <label for="anim-duration">Duration (s)</label>
                        <input type="number" id="anim-duration" class="input" min="0.1" step="0.1" value="5.0">
                    </div>
                    <div class="form-group">
                        <label for="anim-fps">FPS</label>
                        <input type="number" id="anim-fps" class="input" min="1" max="120" value="30">
                    </div>
                </div>

                <div class="panel-section">
                    <h3 class="section-title">Playback Controls</h3>
                    <div class="playback-controls">
                        <button id="btn-play" class="btn btn-play">
                            <svg id="play-icon" viewBox="0 0 24 24" fill="currentColor">
                                <polygon points="5 3 19 12 5 21 5 3"/>
                            </svg>
                            <svg id="pause-icon" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
                                <rect x="6" y="4" width="4" height="16"/>
                                <rect x="14" y="4" width="4" height="16"/>
                            </svg>
                        </button>
                        <button id="btn-stop" class="btn btn-secondary">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <rect x="6" y="6" width="12" height="12"/>
                            </svg>
                        </button>
                        <button id="btn-loop" class="btn btn-secondary" title="Loop">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M21 2v6h-6M3 12a9 9 0 0 1 15-6.7L21 8M3 22v-6h6M21 12a9 9 0 0 1-15 6.7L3 16"/>
                            </svg>
                        </button>
                    </div>
                    <div class="time-display">
                        <span id="current-time">0.00</span> / <span id="total-time">5.00</span>s
                    </div>
                </div>

                <div class="panel-section">
                    <h3 class="section-title">Keyframe Controls</h3>
                    <button id="btn-add-keyframe" class="btn btn-primary btn-full">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 8v8M8 12h8"/>
                        </svg>
                        Add Keyframe
                    </button>
                    <button id="btn-delete-keyframe" class="btn btn-danger btn-full">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M8 12h8"/>
                        </svg>
                        Delete Keyframe
                    </button>
                    <div class="keyframe-info">
                        <p id="keyframe-count">Keyframes: 0</p>
                        <p id="selected-keyframe">Selected: None</p>
                    </div>
                </div>

                <div class="panel-section">
                    <h3 class="section-title">Posture Editor</h3>
                    <div class="toggle-group">
                        <label class="toggle-label">
                            <input id="inverse-kinematics" type="checkbox" class="toggle-input">
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Inverse Kinematics</span>
                        </label>
                        <label class="toggle-label">
                            <input id="biological-constraints" type="checkbox" class="toggle-input" checked>
                            <span class="toggle-slider"></span>
                            <span class="toggle-text">Biological Constraints</span>
                        </label>
                    </div>
                    <button id="btn-reset-pose" class="btn btn-secondary btn-full">
                        Reset Pose
                    </button>
                </div>
            </aside>

            <!-- Center - 3D Viewport -->
            <main class="viewport-container">
                <div id="viewport" class="viewport"></div>
                <div class="viewport-overlay">
                    <div class="viewport-info">
                        <span id="selected-part">No part selected</span>
                    </div>
                </div>
            </main>

            <!-- Right Panel - Timeline -->
            <aside class="right-panel">
                <div class="panel-section">
                    <h3 class="section-title">Timeline</h3>
                    <div class="timeline-container">
                        <div id="timeline" class="timeline">
                            <canvas id="timeline-canvas"></canvas>
                            <div id="playhead" class="playhead"></div>
                        </div>
                    </div>
                </div>

                <div class="panel-section">
                    <h3 class="section-title">Keyframe Details</h3>
                    <div id="keyframe-details" class="keyframe-details">
                        <p class="empty-state">Select a keyframe to view details</p>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Hidden File Input -->
    <input type="file" id="file-input" accept=".json" style="display: none;">

    <!-- Script -->
    <script type="module" src="animation-editor.js"></script>
</body>
</html>
